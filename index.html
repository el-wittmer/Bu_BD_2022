<!DOCTYPE html>
<script src="https://d3js.org/d3.v5.min.js"></script>

<style>
* {
    color: #000;
    font-family: Palatino;
    margin-right: 5%;
    margin-left: 5%;
}
.button {
    margin-left: 0;
}
.link line {stroke: black;}
.node circle {stroke: black; fill: white}
.node text {text-anchor: middle; font-size: 20px}
div.tooltip {	
    position: absolute;			
    text-align: left;			
    width: 400px;					
    height: 100px;					
    padding: 10px;				
    font: 14px Palatino;		
    background: salmon;	
    border: 5px;		
    border-radius: 8px;			
    pointer-events: none;			
}
div.legend {
    position: relative;
    left: 600px;
    top: -200px;
    width: 400px;
    height: 300px;
    font: 14px Palatino;
    background: white;
    border: 5px;
    border-color: black;
    text-align: left;
}
</style>
<head>
<h1>This is Paul et al. (1963).</h1>
</head>

<body onload='init()'>
    <p>Paul et al. (1963) was published at a time when researchers were still trying to figure out the leading causes of 
        Coronary Heart Disease (CHD). Paul et al. (1963) reports a multitude of findings related to CHD, and other researchers
    were able to use these findings in their own research. In this way, Paul et al. (1963) was able to influence researchers
    studying a wide variety of topics under the CHD umbrella. This slide show shows how citations accumulated over the first
    five years of Paul et al.'s (1963) publication, which topic these publications cover, and how these communities built
    around a research topic interact with other communities, if at all. </p>

    <h3><span style="color: salmon; margin-left: 0">The circle represents a publication. Mousing over the circle will show 
    the first author, title, publishing year, publishing journal, and topic.</span></h3>

    <svg width=700 height=200></svg>
<div id="tooltip" opacity=0></div>    
<div id="legend"></div>

<script>
var svg = d3.select("svg")
width = +svg.attr("width"), 
height = +svg.attr("height");

svg.append("circle").attr("cx",10).attr("cy",10).attr("r", 6).style("fill", "red").style("stroke", "black");
svg.append("circle").attr("cx",10).attr("cy",30).attr("r", 6).style("fill", "orange").style("stroke", "black");
svg.append("circle").attr("cx",10).attr("cy",50).attr("r", 6).style("fill", "yellow").style("stroke", "black");
svg.append("circle").attr("cx",10).attr("cy",70).attr("r", 6).style("fill", "green").style("stroke", "black");
svg.append("circle").attr("cx",10).attr("cy",90).attr("r", 6).style("fill", "#a569bd").style("stroke", "black");
svg.append("circle").attr("cx",10).attr("cy",110).attr("r", 6).style("fill", "pink").style("stroke", "black");
svg.append("circle").attr("cx",10).attr("cy",130).attr("r", 6).style("fill", "purple").style("stroke", "black");
svg.append("circle").attr("cx",10).attr("cy",150).attr("r", 6).style("fill", "lightblue").style("stroke", "black");
svg.append("circle").attr("cx",10).attr("cy",170).attr("r", 6).style("fill", "gray").style("stroke", "black");
svg.append("circle").attr("cx",10).attr("cy",190).attr("r", 6).style("fill", "white").style("stroke", "black");

svg.append("text").attr("x", 20).attr("y", 15).text("Serum Cholesterol").style("font-size", "15px");
svg.append("text").attr("x", 20).attr("y", 35).text("Blood Pressure").style("font-size", "15px");
svg.append("text").attr("x", 20).attr("y", 55).text("Caffeine").style("font-size", "15px");
svg.append("text").attr("x", 20).attr("y", 75).text("Diet").style("font-size", "15px");
svg.append("text").attr("x", 20).attr("y", 95).text("Body Fat").style("font-size", "15px");
svg.append("text").attr("x", 20).attr("y", 115).text("Physical Activity").style("font-size", "15px");
svg.append("text").attr("x", 20).attr("y", 135).text("Alcohol").style("font-size", "15px");
svg.append("text").attr("x", 20).attr("y", 155).text("Psychosocial Factors").style("font-size", "15px");
svg.append("text").attr("x", 20).attr("y", 175).text("Smoking").style("font-size", "15px");
svg.append("text").attr("x", 20).attr("y", 195).text("Undefined").style("font-size", "15px");

async function init() {

    const data = await d3.json('https://raw.githubusercontent.com/el-wittmer/Paul_1963/main/Paul_1963.json');
    const color = ["red", 'orange', 'yellow', 'green', '#a569bd', 'pink', 'purple', 'lightblue', 'gray', 'white'];

    var simulation = d3.forceSimulation()
    .force("link", d3.forceLink()
       .id(function(d) {return d.Id;}))
    .force("charge", d3.forceManyBody())
    .force("center",d3.forceCenter(width / 2, height / 2))
    .force("collide", d3.forceCollide(35));

    var nodes = data.nodes;
    simulation.nodes(nodes)

    var div = d3.select("body").append("div")	
    .attr("class", "tooltip")				
    .style("opacity", 0);

    var nodesel = svg.selectAll(".node")
    .data(nodes)
    .enter().append("g")
    .attr("class", "node")
    .call(d3.drag()
    .on("start", dragstarted)
    .on("drag", dragged)
    .on("end", dragended));

    nodesel.append("circle")
    .attr("r", 20)
    .attr("fill", function(d, i) {return data})
    .on("mouseover", function(d) {	
            div.transition()			
                .style("opacity", .9);		
            div	.html("First Author: " + d.First_Author +
                "<br>Title: " + d.Title + 
                "<br>Publication Year: " + d.Publication_Year + 
                "<br>Publication Source: " + d.Publication_Source + 
                "<br>Topic: " + d.Cluster_Name)
                .style("left", (d3.event.pageX) + "px")		
                .style("top", (d3.event.pageY) + "px");	
            })					
        .on("mouseout", function(d) {		
            div.transition()			
                .style("opacity", 0);	
        });

    nodesel.append("text")
    .attr("transform","translate(0,6)")
    .text(function (d) {return d.Id; });
    
    simulation.on("tick", ticked);

    function ticked() {

    nodesel.attr("transform", function(d) {
    return "translate(" + d.x + "," + d.y + ")";
    });
    }
    function dragstarted(d) {
    if (!d3.event.active) simulation.alphaTarget(0.3).restart();
    d.fx = d.x;
    d.fy = d.y;
    }
    function dragged(d) {
    d.fx = d3.event.x;
    d.fy = d3.event.y;
    }
    function dragended(d) {
    if (!d3.event.active) simulation.alphaTarget(0);
    d.fx = null;
    d.fy = null;
    }
    
}
</script>
<br>
<a href="http://el-wittmer.github.io/Paul_1963/1964"><button type="button" class="button">Forward to 1964</button></a>
</body>
</html>
