<!DOCTYPE html>
<script src="https://d3js.org/d3.v5.min.js"></script>

<style>
* {
    color: #000;
    font-family: Palatino;
    margin-right: 5%;
    margin-left: 5%;
}
.button {
    margin-left: 0;
}
.link line {stroke: black;}
.node circle {stroke: black; fill: white}
.node text {text-anchor: middle; font-size: 20px}
div.tooltip {	
    position: absolute;			
    text-align: left;			
    width: 400px;					
    height: 100px;					
    padding: 10px;				
    font: 14px Palatino;		
    background: salmon;	
    border: 5px;		
    border-radius: 8px;			
    pointer-events: none;			
}
</style>
<head>
<h1>This is Paul et al. (1963).</h1>
</head>

<body onload='init()'>
    <p>Paul et al. (1963) was published at a time when researchers were still trying to figure out the leading causes of 
        Coronary Heart Disease (CHD). The predominant hypothesis at the time was that consumption of saturated fats 
        is the leading cause of heart disease. Subsequently, people were advised to reduce their consumption of 
        dietary fats as a means to prevent developing CHD.</p>
    <p>
        Paul et al. followed the lives of 1989 men over the course of five years, tracking various lifestyle factors and seeing
        how these factors may or may not contribute to the development of CHD. The study found no link between
        dietary factors and the development of CHD. The study found that development of CHD
        was positively correlated with elevated serum cholesterol, elevated blood pressure, coffee intake, cigarette smoking, age, and 
        family history.
    </p>
    <p><span style="font-size: 12px; color: salmon; margin-left: 0">The circle represents a publication. Mousing over the circle will show 
    the first author, title, publishing year, and publishing journal.</span></p>
<svg width=400 height=200></svg>
<div id="tooltip" opacity=0></div>    

<script>
var svg = d3.select("svg")
width = +svg.attr("width"), 
height = +svg.attr("height");

async function init() {

    const test = await d3.json('https://raw.githubusercontent.com/el-wittmer/Paul_1963/main/Paul_1963.json');

    var simulation = d3.forceSimulation()
    .force("link", d3.forceLink()
       .id(function(d) {return d.Id;}))
    .force("charge", d3.forceManyBody())
    .force("center",d3.forceCenter(width / 2, height / 2))
    .force("collide", d3.forceCollide(35));

    var nodes = test.nodes;
    simulation.nodes(nodes)

    var div = d3.select("body").append("div")	
    .attr("class", "tooltip")				
    .style("opacity", 0);

    var nodesel = svg.selectAll(".node")
    .data(nodes)
    .enter().append("g")
    .attr("class", "node")
    .call(d3.drag()
    .on("start", dragstarted)
    .on("drag", dragged)
    .on("end", dragended));

    nodesel.append("circle")
    .attr("r", 20)
    .attr("fill", function(d, i) {return test})
    .on("mouseover", function(d) {	
            div.transition()			
                .style("opacity", .9);		
            div	.html("First Author: " + d.First_Author +
                "<br>Title: " + d.Title + 
                "<br>Publication Year: " + d.Publication_Year + 
                "<br>Publication Source: " + d.Publication_Source)
                .style("left", (d3.event.pageX) + "px")		
                .style("top", (d3.event.pageY) + "px");	
            })					
        .on("mouseout", function(d) {		
            div.transition()			
                .style("opacity", 0);	
        });

    nodesel.append("text")
    .attr("transform","translate(0,6)")
    .text(function (d) {return d.Id; });
    
    simulation.on("tick", ticked);

    function ticked() {

    nodesel.attr("transform", function(d) {
    return "translate(" + d.x + "," + d.y + ")";
    });
    }
    function dragstarted(d) {
    if (!d3.event.active) simulation.alphaTarget(0.3).restart();
    d.fx = d.x;
    d.fy = d.y;
    }
    function dragged(d) {
    d.fx = d3.event.x;
    d.fy = d3.event.y;
    }
    function dragended(d) {
    if (!d3.event.active) simulation.alphaTarget(0);
    d.fx = null;
    d.fy = null;
    }
    
}
</script>

<p>Paul et al. is considered a highly-cited paper, as it was cited over 445 times in its first 20 years after publication. 
    As Paul et al.'s findings did not support the popular hypothesis at the time, this is unusual. Were the citing papers reporting
    the negative findings? Or were they reporting on some of the other findings presented in the paper? Is the research 
    citing Paul et al. consistent over time, or does the topic of focus shift over time? 
</p>
<p>To start, we will look at the papers cited within the first year of Paul et al.'s publication.
</p>
<a href="http://el-wittmer.github.io/Paul_1963/1964"><button type="button" class="button">Forward to 1964</button></a>
</body>
</html>
